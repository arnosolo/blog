<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>搭建51单片机开发环境 | 阿诺的文章</title>
    <meta name="description" content="A VitePress site">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/blog/assets/style.Bk91WQOR.css" as="style">
    <link rel="preload stylesheet" href="/blog/vp-icons.css" as="style">
    
    <script type="module" src="/blog/assets/app.BZSeh7ol.js"></script>
    <link rel="preload" href="/blog/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/blog/assets/chunks/theme.BuzeuyaJ.js">
    <link rel="modulepreload" href="/blog/assets/chunks/framework.CLNW5JS9.js">
    <link rel="modulepreload" href="/blog/assets/zh-CN_6-setup-development-environment-for-51-mcu.md.NRoX6mxV.lean.js">
    <link rel="icon" href="/blog/big-yellow.svg">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0b0ada53></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0b0ada53>Skip to content</a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/blog/zh-CN/" data-v-1168a8e4><!--[--><!--]--><!--[--><img class="VPImage logo" src="/blog/big-yellow.svg" alt data-v-8426fc1a><!--]--><span data-v-1168a8e4>阿诺的文章</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Home</span><!--]--></a><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-6aa21345 data-v-88af2de4 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><span class="vpi-languages option-icon" data-v-cf11d7a2></span><!----><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><div class="items" data-v-88af2de4><p class="title" data-v-88af2de4>简体中文</p><!--[--><div class="VPMenuLink" data-v-88af2de4 data-v-35975db6><a class="VPLink link" href="/blog/6-setup-development-environment-for-51-mcu.html" data-v-35975db6><!--[--><span data-v-35975db6>English</span><!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6aa21345 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/arnosolo/" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://x.com/arno_solo_756" aria-label="x" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-x"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><div class="group translations" data-v-bb2aa2f0><p class="trans-title" data-v-bb2aa2f0>简体中文</p><!--[--><div class="VPMenuLink" data-v-bb2aa2f0 data-v-35975db6><a class="VPLink link" href="/blog/6-setup-development-environment-for-51-mcu.html" data-v-35975db6><!--[--><span data-v-35975db6>English</span><!--]--></a></div><!--]--></div><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/arnosolo/" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://x.com/arno_solo_756" aria-label="x" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-x"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-8a42e2b4><button data-v-8a42e2b4>Return to top</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>On this page</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _blog_zh-CN_6-setup-development-environment-for-51-mcu" data-v-39a288b8><div><h1 id="搭建51单片机开发环境" tabindex="-1">搭建51单片机开发环境 <a class="header-anchor" href="#搭建51单片机开发环境" aria-label="Permalink to &quot;搭建51单片机开发环境&quot;">​</a></h1><h2 id="效果展示" tabindex="-1">效果展示 <a class="header-anchor" href="#效果展示" aria-label="Permalink to &quot;效果展示&quot;">​</a></h2><p>点亮<code>D2</code>LED灯 <img src="/blog/assets/609301928e19be72f5574acb143a373156abe1784da065a7aadd7e8e06b7bd15.Bt-J-wLP.jpeg" alt="picture 0"></p><h2 id="前提条件" tabindex="-1">前提条件 <a class="header-anchor" href="#前提条件" aria-label="Permalink to &quot;前提条件&quot;">​</a></h2><ol><li>已学习<code>微机原理</code></li><li>了解如何在终端中运行<code>指令</code></li><li>一块<code>51单片机开发板</code>(本文采用了普中A2开发板, MCU为STC89C52RC)</li><li>下载<code>开发板原理图</code>. <a href="http://www.prechin.cn/gongsixinwen/208.html" target="_blank" rel="noreferrer">普中科技-各型号产品资料下载链接</a></li><li>下载<code>STC89C52RC数据手册</code>. <a href="https://www.stcmicro.com/cn/sjsc.html" target="_blank" rel="noreferrer">STC 技术支持 数据手册</a></li></ol><h2 id="原理解析" tabindex="-1">原理解析 <a class="header-anchor" href="#原理解析" aria-label="Permalink to &quot;原理解析&quot;">​</a></h2><ol><li>打开<code>开发板原理图</code>, 找到<code>D2</code>LED灯. 发现其一端连着<code>VCC</code>, 另一端连着<code>P2.1</code>引脚.</li><li>打开<code>STC89C52RC数据手册</code>, 找到管脚说明章节. 发现<code>P2.1</code>引脚内部有上拉电阻, 未使用时为高电平, 故<code>D2</code>LED灯默认不亮, 需要单片机将<code>P2.1</code>引脚设置为低电平才会亮. 这一步需要修改单片机中的程序才能实现.</li><li>修改单片机中的程序总共需要3步. <code>main.c</code> -编译-&gt; <code>firmware.hex</code> -烧录-&gt; <code>MCU ROM</code><ul><li>使用c语言编写一个文本文件<code>main.c</code></li><li>使用编译器将<code>main.c</code>文件转换为一个机器码文件<code>firmware.hex</code>(当然也可以叫其它名字)</li><li>使用烧录器将<code>firmware.hex</code>文件烧录到单片机ROM中</li></ul></li></ol><h2 id="实现" tabindex="-1">实现 <a class="header-anchor" href="#实现" aria-label="Permalink to &quot;实现&quot;">​</a></h2><h3 id="安装编译器-sdcc" tabindex="-1">安装编译器 SDCC <a class="header-anchor" href="#安装编译器-sdcc" aria-label="Permalink to &quot;安装编译器 SDCC&quot;">​</a></h3><p>本文使用的编译器是<a href="https://sdcc.sourceforge.net/" target="_blank" rel="noreferrer">SDCC</a>.</p><ul><li>Window: 打开上述网站下载并安装</li><li>Linux: 使用包管理工具安装</li><li>macOS: 使用 Homebrew 安装<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sdcc</span></span></code></pre></div></li></ul><p>安装完成后, 查看<code>SDCC</code>版本, 如果有输出说明安装成功.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sdcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span></code></pre></div><h3 id="编写源码" tabindex="-1">编写源码 <a class="header-anchor" href="#编写源码" aria-label="Permalink to &quot;编写源码&quot;">​</a></h3><p>示例代码 codes/demo200-51-led</p><ol><li>打开<code>STC89C52RC数据手册</code>, 找到<code>P2</code>寄存器的地址为<code>0xA0</code>(3.3特殊功能寄存器), 寄存器默认值为<code>0b11111111</code>. 如果需要将<code>P2.1</code>引脚设置为低电平, 则需要将改寄存器的值修改为<code>0b10111111</code></li><li>打开<a href="https://sdcc.sourceforge.net/doc/sdccman.pdf" target="_blank" rel="noreferrer">SDCC 用户手册</a>. 发现存在两个关键字<code>__sfr</code>和<code>__sbit</code>. 它们的作用分别为: <ul><li>__sfr(Special Function Register)关键字用于声明 8051 微控制器中的特殊功能寄存器, 这些寄存器与微控制器的特定硬件功能（如端口、定时器、串口等）直接相关. __sfr 允许程序员通过变量名直接访问这些寄存器.</li></ul><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">__sfr </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">__at</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) P0;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // P0 被声明为一个特殊功能寄存器, 地址为 0x80</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> 0b</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00001111</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       // 将 P0 寄存器的值设置为 0b00001111</span></span></code></pre></div><ul><li>__sbit(Special Bit)关键字用于声明和访问特殊功能寄存器中的单个位, 通常用于直接控制或读取某个位的状态, 比如控制引脚的高低电平</li></ul><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">__sbit </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">__at</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) P0_0;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // P0_0 被声明为一个特殊位, 对应 P0 端口的第 0 位</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> P1_0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // 将 P1.0 设为低电平</span></span></code></pre></div></li><li>创建文件夹<code>demo200-51-led</code></li><li>创建文件<code>demo200-51-led/src/main.c</code><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __sbit </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">__at</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">A1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) P2_1 ;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   P2_1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 将 P2.1 设为低电平</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span></code></pre></div></li></ol><h3 id="编译" tabindex="-1">编译 <a class="header-anchor" href="#编译" aria-label="Permalink to &quot;编译&quot;">​</a></h3><ol><li>使用编译器将<code>main.c</code>文件转换为一个机器码文件<code>firmware.hex</code><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 如需</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sdcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build/firmware.hex</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> src/main.c</span></span></code></pre></div></li><li>打开<code>firmware.hex</code>文件, 发现内容物是一堆机器码.<div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span> :03000000020006F5</span></span>
<span class="line"><span> ...</span></span>
<span class="line"><span> :00000001FF</span></span></code></pre></div></li></ol><h3 id="烧录" tabindex="-1">烧录 <a class="header-anchor" href="#烧录" aria-label="Permalink to &quot;烧录&quot;">​</a></h3><p>我们打开<code>STC89C52RC数据手册</code>, 10.1.1 在系统可编程（ISP）原理使用说明. 了解到给<code>STC89C52RC微控制器</code>烧录程序有 5 个步骤, 其中前两个步骤需要程序员来进行操作. <img src="/blog/assets/e23edca33a1dc7cd2a7069f82af5dd983f26bd3a3af50e15d48c7df8c0903647.C7LfcjyU.png" alt="picture 1"></p><ol><li>程序员使用PC端烧录软件向单片机传输命令流</li><li>程序员手动给单片机上电复位</li><li>单片机复位后检测RxD是否有合法下载命令流</li><li>单片机下载用户程序</li><li>单片机进入用户程序区</li></ol><p>了解了基本流程后, 我们开始实现这个流程.</p><ol><li>查看<code>开发板原理图</code>得知该开发板使用<code>CH340</code>芯片, 通过该芯片USB信号转换为TTL（Transistor-Transistor Logic）电平信号, 进而将程序从PC下载到单片机. 为此我们将需要安装<code>CH340</code>芯片的驱动, 使得PC能够将开发板识别为一个普普通通的USB设备.</li><li>在 Linux, macOS上你可以通过查看<code>/dev/</code>文件夹的文件列表来查看操作系统设备到的设备.<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ls</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/cu</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 使用CH340芯片的USB设备一般是cu开头</span></span></code></pre></div></li><li>(如需)根据你的PC的操作系统安装对于的驱动 <a href="https://www.wch.cn/downloads/CH341SER_ZIP.html" target="_blank" rel="noreferrer">wch CH341 驱动下载</a>. 安装完成后再次列出设备, 看看PC是否已经设备到开发板. 我的设备路径是<code>/dev/cu.usbserial-140</code></li><li>(如需)本次我们将使用<a href="https://github.com/grigorig/stcgal" target="_blank" rel="noreferrer">stcgal 烧录器</a>进行烧录. 请根据文档要求进行安装<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stcgal</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stcgal</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -V</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 验证安装, 成功会返回版本号</span></span></code></pre></div></li><li>将开发板连接到PC, 按下开发板电源开关, 使得开发板通上电.</li><li>运行烧录指令, 获得提示 &quot;Waiting for MCU, please cycle power&quot;.<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sdcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build/firmware.hex</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> src/main.c</span></span></code></pre></div></li><li>根据提醒, 按下开发板电源开关, 开发板断电. 再次按下开发板电源开关, 开发板通电. 如果一切运行良好, 终端中会打印出一些文字, 类似&quot;Writing flash: 640 Bytes [00:00, 7483.63 Bytes/s]&quot;. 显示出PC正在向单片机传输程序.</li><li>传输完成后, 单片机会自动开始运行收到的用户程序. 也就是我此时我们应该能看到<code>D2</code>LED灯被点亮.</li></ol><p>额外练习:</p><ul><li>通过修改<code>P2</code>寄存器的值来控制LED灯的亮灭.</li></ul><h3 id="可选-安装-platformio" tabindex="-1">(可选)安装 PlatformIO <a class="header-anchor" href="#可选-安装-platformio" aria-label="Permalink to &quot;(可选)安装 PlatformIO&quot;">​</a></h3><p>尽管我们在命令行中手动完成整个流程, 但是使用安装<code>PlatformIO</code>可以一些额外的好处. 比如说, 自动找到开发板的设备名称.</p><p>示例代码 codes/demo201-51-platformio-led</p><ol><li>下载<code>VS Code</code></li><li>在<code>VS Code</code>中安装<code>PlatformIO</code>插件</li><li>创建<code>PlatformIO</code>工程, 开发板型号选择<code>STC89C52RC</code></li><li>编写<code>main.c</code></li><li>编译工程以生成机器码文件 <code>.pio/build/STC89C52RC/firmware.hex</code><ul><li>选项1: 使用<code>PlatformIO</code>插件的<code>Build</code>按钮</li><li>选择2: PlatformIO CLI(需要手动安装, 然后把路径添加到环境变量中)<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pio</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span></span></code></pre></div></li></ul></li><li>将机器码文件烧录进<code>MCU</code>中. <code>Platform IO</code>自带烧录器, 但是我实际操作没有成功过, 所以我采用的都是手动模式<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用 pio</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pio</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --target</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> upload</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用 stcgal</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stcgal</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -P</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stc89</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/cu.usbserial-140</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./.pio/build/STC89C52RC/firmware.hex</span></span></code></pre></div></li></ol></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><!----><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"1-web-dev-articles.md\":\"CZ08BPAR\",\"10-how-to-set-up-lunar-birthday-reminders.md\":\"KNFcM-xp\",\"11-products.md\":\"O8FxOvw0\",\"12-big-yellow-diary-introduction.md\":\"CHstVMVs\",\"13-big-yellow-diary-privacy-policy.md\":\"DcGKQMxh\",\"14-big-yellow-diary-support.md\":\"CfUAx5bJ\",\"15-swift-custom-errors.md\":\"CdIuzapS\",\"17-swiftui-state-management.md\":\"DzdNWuin\",\"18-swiftui-image-picker.md\":\"BrvGryWm\",\"19-swift-async-await.md\":\"B1ImGLNy\",\"2-frontend-developer-roadmap.md\":\"BcGv1hnu\",\"20-swiftui-photo-capturer.md\":\"CMnUrsyY\",\"21-swiftui-save-photo-to-photo-library.md\":\"DMb1l7FF\",\"22-ios-data-persistence-using-core-data.md\":\"Xzl2T3A0\",\"23-swiftui-unit-testing-with-xctest.md\":\"DusTYYEG\",\"24-swiftui-speech-recognition.md\":\"auSp3qKG\",\"25-test-subscription-feature-of-an-ios-app.md\":\"SV27tkki\",\"26-swiftui-connect-to-a-http-server.md\":\"19_vWDM3\",\"27-my-tomatoes-privacy-policy.md\":\"BUrOCoUX\",\"28-my-tomatoes-support.md\":\"HvRPkBir\",\"29-my-tomatoes-about.md\":\"BVg9P7Sy\",\"3-embedded-system-articles.md\":\"CH6RottO\",\"30-my-tomatoes-introduction.md\":\"DZyVu-pl\",\"31-ios-local-notification.md\":\"BTdfshTz\",\"32-ios-custom-notification-sound.md\":\"DqLVRvqG\",\"33-rate-my-items-privacy-policy.md\":\"hfHv4-m1\",\"34-rate-my-items-support.md\":\"DujqMM7D\",\"35-rate-my-items-introduction.md\":\"C5kqpWfe\",\"36-photo-collage-privacy-policy.md\":\"DCM0b24r\",\"37-photo-collage-support.md\":\"BuZFea4e\",\"4-ios-dev-articles.md\":\"CNY6zWZt\",\"5-build-ios-app-with-xcode-cloud.md\":\"DCQC33Kr\",\"api-examples.md\":\"BgAPd291\",\"big-yellow-music-player-introduction.md\":\"CK585ZUC\",\"big-yellow-music-player-privacy-policy.md\":\"seg17s4l\",\"big-yellow-music-player-support.md\":\"C1oNugoB\",\"birthday-reminder-privacy-policy.md\":\"9vZwX4S1\",\"birthday-reminder-support.md\":\"cHKsJCFJ\",\"birthday-reminder-terms-of-use.md\":\"BrAvCM1K\",\"customizable-calculator-introduction.md\":\"B8X49yg6\",\"customizable-calculator-privacy-policy.md\":\"BYA72JuH\",\"customizable-calculator-support.md\":\"BVhj3yZz\",\"exif-editor-introduction.md\":\"CsQMyoxd\",\"exif-editor-privacy-policy.md\":\"OInp_BBV\",\"exif-editor-support.md\":\"DRwijZnO\",\"exif-editor-terms-of-use.md\":\"D6mHf-8b\",\"index.md\":\"BpJY5p2J\",\"legacy.md\":\"CI3VQvV2\",\"markdown-examples.md\":\"zgPxf0fh\",\"metadata-watermark-introduction.md\":\"DwHVjPj4\",\"metadata-watermark-privacy-policy.md\":\"DUwnWdAk\",\"metadata-watermark-support.md\":\"OhIZLtgy\",\"metadata-watermark-terms-of-use.md\":\"DHO7dY8X\",\"zh-cn_1-web-dev-articles.md\":\"Cpu3j0PN\",\"zh-cn_10-how-to-set-up-lunar-birthday-reminders.md\":\"B4DYvHlf\",\"zh-cn_11-products.md\":\"AXTOq2ZX\",\"zh-cn_12-big-yellow-diary-introduction.md\":\"BuB0MJEO\",\"zh-cn_15-swift-custom-errors.md\":\"B-Qv9NBN\",\"zh-cn_17-swiftui-state-management.md\":\"DS90gDy5\",\"zh-cn_18-swiftui-image-picker.md\":\"ZbWdASFJ\",\"zh-cn_19-swift-async-await.md\":\"DfBDbtzc\",\"zh-cn_2-frontend-developer-roadmap.md\":\"Bpq0Rwkz\",\"zh-cn_20-swiftui-photo-capturer.md\":\"CGRlPXOY\",\"zh-cn_21-swiftui-save-photo-to-photo-library.md\":\"i04LwIJx\",\"zh-cn_22-ios-data-persistence-using-core-data.md\":\"DeQ1uWtH\",\"zh-cn_23-swiftui-unit-testing-with-xctest.md\":\"DjTUCVao\",\"zh-cn_24-swiftui-speech-recognition.md\":\"Bk-oA5YJ\",\"zh-cn_25-test-subscription-feature-of-an-ios-app.md\":\"B7qYZOJV\",\"zh-cn_26-swiftui-connect-to-a-http-server.md\":\"C0oiShOH\",\"zh-cn_3-embedded-system-articles.md\":\"BoGisrdw\",\"zh-cn_30-my-tomatoes-introduction.md\":\"BdGuEdv7\",\"zh-cn_31-ios-local-notification.md\":\"BkQVcotu\",\"zh-cn_32-ios-custom-notification-sound.md\":\"w9QOlyt9\",\"zh-cn_35-rate-my-items-introduction.md\":\"Cu4TH0nI\",\"zh-cn_4-ios-dev-articles.md\":\"DaKiZ12o\",\"zh-cn_5-build-ios-app-with-xcode-cloud.md\":\"Cyscfpvy\",\"zh-cn_6-setup-development-environment-for-51-mcu.md\":\"NRoX6mxV\",\"zh-cn_7-51-mcu-timer.md\":\"Ch305g38\",\"zh-cn_8-51-mcu-uart.md\":\"2VNcpTW4\",\"zh-cn_9-51-mcu-i2c.md\":\"DAVo5G2f\",\"zh-cn_big-yellow-music-player-introduction.md\":\"B-ot0_-N\",\"zh-cn_customizable-calculator-introduction.md\":\"wD_eXDKr\",\"zh-cn_exif-editor-introduction.md\":\"7jiuTWrk\",\"zh-cn_index.md\":\"BWbFZsXC\",\"zh-cn_metadata-watermark-introduction.md\":\"BNKTEUBE\",\"zh-tw_11-products.md\":\"NpuPFr_d\",\"zh-tw_30-my-tomatoes-introduction.md\":\"Cek9Rj43\",\"zh-tw_index.md\":\"B5ETciY7\",\"zh-tw_metadata-watermark-introduction.md\":\"BiGE4RCJ\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"VitePress\",\"description\":\"A VitePress site\",\"base\":\"/blog/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/big-yellow.svg\",\"nav\":[{\"text\":\"Home\",\"link\":\"/\"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/arnosolo/\"},{\"icon\":\"x\",\"link\":\"https://x.com/arno_solo_756\"}],\"outline\":[2,3]},\"locales\":{\"root\":{\"label\":\"English\",\"lang\":\"en\",\"title\":\"Arno's blog\"},\"zh-CN\":{\"label\":\"简体中文\",\"lang\":\"zh-CN\",\"link\":\"/zh-CN/\",\"title\":\"阿诺的文章\"}},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>